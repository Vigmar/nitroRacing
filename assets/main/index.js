System.register("chunks:///_virtual/AICar.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,r,n,a,s,o,l,c,u,g,h;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,r=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){a=e.cclegacy,s=e._decorator,o=e.RigidBody,l=e.Vec3,c=e.Quat,u=e.PhysicsSystem,g=e.geometry,h=e.Component}],execute:function(){var d,p,y,f,A;a._RF.push({},"c3063WtAbVOE7zaj4q7k2dr","AICar",void 0);var m=s.ccclass,v=s.property;e("AICar",m("AICar")((y=t((p=function(e){function t(){for(var t,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return t=e.call.apply(e,[this].concat(a))||this,r(t,"speed",y,n(t)),r(t,"turnSpeed",f,n(t)),r(t,"maxSteerAngle",A,n(t)),t.rigidBody=null,t.direction=new l(0,0,-1),t.steeringAngle=0,t.avoidForce=new l,t}i(t,e);var a=t.prototype;return a.start=function(){this.rigidBody=this.getComponent(o),this.setupObstacleAvoidance()},a.update=function(e){this.avoidObstacles(),this.move(e)},a.move=function(e){if(this.rigidBody){var t=this.node.forward.multiplyScalar(-1).multiplyScalar(this.speed*e);if(this.rigidBody.applyForce(t.multiplyScalar(30)),0!==this.steeringAngle){var i=new l(0,this.steeringAngle*this.turnSpeed*e,0);this.rigidBody.applyTorque(i);var r=new l(10*this.steeringAngle*e,0,0);this.rigidBody.applyForce(r)}}},a.setupObstacleAvoidance=function(){},a.avoidObstacles=function(){var e=this.node.forward.multiplyScalar(-1);this.steeringAngle=0,this.avoidForce.set(0,0,0);var t=this.node.up,i=30*Math.PI/180,r=-30*Math.PI/180,n=new c;c.fromAxisAngle(n,t,i);var a=new c;c.fromAxisAngle(a,t,r);var s=new l,o=new l;l.transformQuat(s,e,n),l.transformQuat(o,e,a),s.normalize(),o.normalize(),this.steeringAngle=0,this.raycast(s,25)&&(this.steeringAngle=-this.maxSteerAngle/2),this.raycast(o,25)&&(this.steeringAngle+=this.maxSteerAngle/2),this.raycast(e,25)&&(this.steeringAngle<0?this.steeringAngle=-this.maxSteerAngle:this.steeringAngle=this.maxSteerAngle)},a.raycast=function(e,t){if(!u.instance)return!1;var i=this.node.worldPosition,r=new g.Ray;l.copy(r.o,i),l.copy(r.d,e);var n=null;try{u.instance.raycastClosest(r,4294967295,t)&&(n=u.instance.raycastClosestResult)}catch(e){return console.error("Ошибка при вызове raycastClosest:",e),!1}if(n){n.hitPoint;return n.collider.node!==this.node}return!1},t}(h)).prototype,"speed",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),f=t(p.prototype,"turnSpeed",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),A=t(p.prototype,"maxSteerAngle",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 30}}),d=p))||d);a._RF.pop()}}}));

System.register("chunks:///_virtual/CameraFollow.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,o,r,n,s,a,l,f,p;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,o=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){n=e.cclegacy,s=e._decorator,a=e.Node,l=e.Vec3,f=e.math,p=e.Component}],execute:function(){var u,c,d,h,m,y,w,b,g,P,z,v,x;n._RF.push({},"41078GzJZ9I0r0kslqb6iM/","CameraFollow",void 0);e("CameraFollow",(u=s.ccclass("CameraFollow"),c=s.property({type:a}),d=s.property,h=s.property,m=s.property,y=s.property,u((g=t((b=function(e){function t(){for(var t,i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return t=e.call.apply(e,[this].concat(n))||this,o(t,"target",g,r(t)),o(t,"offset",P,r(t)),o(t,"sideOffsetFactor",z,r(t)),o(t,"smoothSpeed",v,r(t)),o(t,"maxSideOffset",x,r(t)),t.desiredPosition=new l,t.smoothedPosition=new l,t}return i(t,e),t.prototype.update=function(e){if(this.target){var t=this.target.worldPosition,i=this.target.worldRotation,o=new l;i.getEulerAngles(o);var r=o.y,n=new l,s=f.clamp(r/45,-1,1);n.x=-s*this.maxSideOffset;new l(this.offset.x+n.x,this.offset.y,this.offset.z);l.transformQuat(this.desiredPosition,this.offset,i),l.add(this.desiredPosition,this.desiredPosition,t),this.smoothedPosition.lerp(this.desiredPosition,this.smoothSpeed*e),this.node.worldPosition=this.smoothedPosition;var a=new l(t.x,t.y+1,t.z);this.node.lookAt(a)}},t}(p)).prototype,"target",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(b.prototype,"offset",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new l(0,3,-5)}}),z=t(b.prototype,"sideOffsetFactor",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),v=t(b.prototype,"smoothSpeed",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),x=t(b.prototype,"maxSideOffset",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),w=b))||w));n._RF.pop()}}}));

System.register("chunks:///_virtual/CarController.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,r,i,n,a,o,s,p,u,l,c,g,y,h,d,m,f;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,i=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){a=e.cclegacy,o=e._decorator,s=e.RigidBody,p=e.Node,u=e.SpriteFrame,l=e.input,c=e.Input,g=e.KeyCode,y=e.math,h=e.Vec3,d=e.Quat,m=e.Sprite,f=e.Component}],execute:function(){var b,S,w,F,B,v,z,N,E,A,k,C,I,K,_,x,D,T,R,Y,L,M,P,U,O,W,H,V,Q,j,q,Z,G,J,X,$,ee;a._RF.push({},"57df0hk2QhNIqQ9WAAt5mD+","CarController",void 0);e("CarController",(b=o.ccclass("CarController"),S=o.property({type:s}),w=o.property({displayName:"Max Speed",min:0}),F=o.property({displayName:"Acceleration",min:0}),B=o.property({displayName:"Deceleration",min:0}),v=o.property({displayName:"Steering Force",min:0}),z=o.property({displayName:"Max Steering Angle",min:0,max:45}),N=o.property({displayName:"Steering Responsiveness",min:.1,max:1}),E=o.property({displayName:"Drag",min:0}),A=o.property({displayName:"Down Force",min:0}),k=o.property({type:p,displayName:"Forward Button"}),C=o.property({type:p,displayName:"Backward Button"}),I=o.property({type:p,displayName:"Left Button"}),K=o.property({type:p,displayName:"Right Button"}),_=o.property({type:[u],displayName:"Forward Frames [Normal, Pressed]"}),x=o.property({type:[u],displayName:"Stop Frames [Normal, Pressed]"}),D=o.property({type:[u],displayName:"Left Frames [Normal, Pressed]"}),T=o.property({type:[u],displayName:"Right Frames [Normal, Pressed]"}),b((L=t((Y=function(e){function t(){for(var t,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,i(t,"rigidBody",L,n(t)),i(t,"maxSpeed",M,n(t)),i(t,"acceleration",P,n(t)),i(t,"deceleration",U,n(t)),i(t,"steeringForce",O,n(t)),i(t,"maxSteeringAngle",W,n(t)),i(t,"steeringResponsiveness",H,n(t)),i(t,"drag",V,n(t)),i(t,"downForce",Q,n(t)),i(t,"buttonF",j,n(t)),i(t,"buttonB",q,n(t)),i(t,"buttonL",Z,n(t)),i(t,"buttonR",G,n(t)),i(t,"forwardFrames",J,n(t)),i(t,"backwardFrames",X,n(t)),i(t,"leftFrames",$,n(t)),i(t,"rightFrames",ee,n(t)),t.currentSpeed=0,t.currentSteering=0,t.targetSteeringInput=0,t.isAccelerating=!0,t.isBraking=!1,t}r(t,e);var a=t.prototype;return a.onLoad=function(){var e=this;l.on(c.EventType.KEY_DOWN,this.onKeyDown,this),l.on(c.EventType.KEY_UP,this.onKeyUp,this),this.setupTouchButtons(),setTimeout((function(){return e.isAccelerating=!1}),1e3)},a.onDestroy=function(){l.off(c.EventType.KEY_DOWN,this.onKeyDown,this),l.off(c.EventType.KEY_UP,this.onKeyUp,this),this.setupTouchButtons()},a.setupTouchButtons=function(){var e=this,t=function(t,r,i,n){if(console.log(r,t),t&&r[0]&&r[1]){var a=t.getComponent(m);a?(console.log("S",a),a.spriteFrame=r[0],t.on(p.EventType.TOUCH_START,(function(e){a.spriteFrame=r[1],i(),e.propagationStopped=!0}),e),t.on(p.EventType.TOUCH_END,(function(e){a.spriteFrame=r[0],n(),e.propagationStopped=!0}),e),t.on(p.EventType.TOUCH_CANCEL,(function(e){a.spriteFrame=r[0],n(),e.propagationStopped=!0}),e)):console.error("Sprite component missing on button:",t.name)}else console.warn("Button or frames missing:",null==t?void 0:t.name)};t(this.buttonF,this.forwardFrames,(function(){return e.isAccelerating=!0}),(function(){return e.isAccelerating=!1})),t(this.buttonB,this.backwardFrames,(function(){return e.isBraking=!0}),(function(){return e.isBraking=!1})),t(this.buttonL,this.leftFrames,(function(){1!==e.targetSteeringInput&&(e.targetSteeringInput=1)}),(function(){1===e.targetSteeringInput&&(e.targetSteeringInput=0)})),t(this.buttonR,this.rightFrames,(function(){-1!==e.targetSteeringInput&&(e.targetSteeringInput=-1)}),(function(){-1===e.targetSteeringInput&&(e.targetSteeringInput=0)}))},a.onKeyDown=function(e){switch(e.keyCode){case g.KEY_W:this.isAccelerating=!0;break;case g.KEY_S:this.isBraking=!0;break;case g.KEY_A:this.targetSteeringInput=1;break;case g.KEY_D:this.targetSteeringInput=-1}},a.onKeyUp=function(e){switch(e.keyCode){case g.KEY_W:this.isAccelerating=!1;break;case g.KEY_S:this.isBraking=!1;break;case g.KEY_A:1===this.targetSteeringInput&&(this.targetSteeringInput=0);break;case g.KEY_D:-1===this.targetSteeringInput&&(this.targetSteeringInput=0)}},a.update=function(e){if(this.currentSteering=y.lerp(this.currentSteering,this.targetSteeringInput,this.steeringResponsiveness*e*10),this.isAccelerating?this.currentSpeed=Math.min(this.currentSpeed+this.acceleration*e,this.maxSpeed):this.isBraking?this.currentSpeed=Math.max(this.currentSpeed-this.deceleration*e,-this.maxSpeed/2):Math.abs(this.currentSpeed),Math.abs(this.currentSpeed)>.1){var t=this.node.forward.clone().multiplyScalar(-this.currentSpeed);this.rigidBody.setLinearVelocity(new h(t.x,0,t.z))}if(0!==this.currentSteering&&Math.abs(this.currentSpeed)>.1){var r=y.toRadian(this.maxSteeringAngle)*this.currentSteering,i=Math.sin(r)*this.currentSpeed*this.steeringForce,n=this.node.right.clone(),a=this.node.forward.clone(),o=n.multiplyScalar(-i*e*100);this.rigidBody.applyForce(o,a)}this.applyDownForce(),this.stabilizeCar(e)},a.applyDownForce=function(){var e=-this.downForce*Math.abs(this.currentSpeed),t=new h(0,e,0);this.rigidBody.applyForce(t,h.ZERO)},a.stabilizeCar=function(e){var t=this.rigidBody.angularVelocity,r=5*e,i=new h(t.x*(1-r),t.y*(1-.5*r),t.z*(1-r));this.rigidBody.setAngularVelocity(i);var n=this.node.rotation,a=n.getEulerAngles(new h);a.x=y.lerp(a.x,0,5*e),a.z=y.lerp(a.z,0,5*e),d.fromEuler(n,a.x,a.y,a.z)},t}(f)).prototype,"rigidBody",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=t(Y.prototype,"maxSpeed",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),P=t(Y.prototype,"acceleration",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),U=t(Y.prototype,"deceleration",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 8}}),O=t(Y.prototype,"steeringForce",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),W=t(Y.prototype,"maxSteeringAngle",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 30}}),H=t(Y.prototype,"steeringResponsiveness",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),V=t(Y.prototype,"drag",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.9}}),Q=t(Y.prototype,"downForce",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),j=t(Y.prototype,"buttonF",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(Y.prototype,"buttonB",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=t(Y.prototype,"buttonL",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(Y.prototype,"buttonR",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(Y.prototype,"forwardFrames",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),X=t(Y.prototype,"backwardFrames",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),$=t(Y.prototype,"leftFrames",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ee=t(Y.prototype,"rightFrames",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),R=Y))||R));a._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./AICar.ts","./CameraFollow.ts","./CarController.ts"],(function(){return{setters:[null,null,null],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});